\chapter{Parallax Occlusion Mapping Node}
\hypertarget{md__hey_tea_9_2_library_2_package_cache_2com_8unity_8shadergraph_0d14_80_88_2_documentation_0i_2cc7285ab42c16b0a6e9a6671da5ba147}{}\label{md__hey_tea_9_2_library_2_package_cache_2com_8unity_8shadergraph_0d14_80_88_2_documentation_0i_2cc7285ab42c16b0a6e9a6671da5ba147}\index{Parallax Occlusion Mapping Node@{Parallax Occlusion Mapping Node}}
\label{md__hey_tea_9_2_library_2_package_cache_2com_8unity_8shadergraph_0d14_80_88_2_documentation_0i_2cc7285ab42c16b0a6e9a6671da5ba147_autotoc_md3584}%
\Hypertarget{md__hey_tea_9_2_library_2_package_cache_2com_8unity_8shadergraph_0d14_80_88_2_documentation_0i_2cc7285ab42c16b0a6e9a6671da5ba147_autotoc_md3584}%
 \hypertarget{md__hey_tea_9_2_library_2_package_cache_2com_8unity_8shadergraph_0d14_80_88_2_documentation_0i_2cc7285ab42c16b0a6e9a6671da5ba147_autotoc_md3585}{}\doxysection{\texorpdfstring{Description}{Description}}\label{md__hey_tea_9_2_library_2_package_cache_2com_8unity_8shadergraph_0d14_80_88_2_documentation_0i_2cc7285ab42c16b0a6e9a6671da5ba147_autotoc_md3585}
You can use the Parallax Occlusion Mapping (POM) node to create a parallax effect that displaces a material\textquotesingle{}s UVs and depth to create the illusion of depth inside that material.

If you receive a texture sampling error while using this node in a graph that includes Custom Function nodes or Subgraphs, try upgrading to Shader Graph version 10.\+3 or later. This may resolve the errors.

When you assign the same Texture2D to a POM node and a Sample Texture 2D node, you need to avoid transforming the UV coordinates twice. To prevent this, connect the Split Texture Transform node’s {\bfseries{Texture Only}} port to the Sample Texture 2D Node’s {\bfseries{UV}} port.

\hypertarget{md__hey_tea_9_2_library_2_package_cache_2com_8unity_8shadergraph_0d14_80_88_2_documentation_0i_2cc7285ab42c16b0a6e9a6671da5ba147_autotoc_md3586}{}\doxysection{\texorpdfstring{Ports}{Ports}}\label{md__hey_tea_9_2_library_2_package_cache_2com_8unity_8shadergraph_0d14_80_88_2_documentation_0i_2cc7285ab42c16b0a6e9a6671da5ba147_autotoc_md3586}
\tabulinesep=1mm
\begin{longtabu}spread 0pt [c]{*{4}{|X[-1]}|}
\hline
\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ Name   }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ {\bfseries{Direction}}   }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ Type   }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ Description    }\\\cline{1-4}
\endfirsthead
\hline
\endfoot
\hline
\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ Name   }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ {\bfseries{Direction}}   }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ Type   }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ Description    }\\\cline{1-4}
\endhead
{\bfseries{Heightmap}}   &Input   &Texture2D   &The Texture that specifies the depth of the displacement.    \\\cline{1-4}
{\bfseries{Heightmap Sampler}}   &Input   &Sampler State   &The Sampler to sample {\bfseries{Heightmap}} with.    \\\cline{1-4}
{\bfseries{Amplitude}}   &Input   &Float   &A multiplier to apply to the height of the {\bfseries{Heightmap}} (in centimeters).    \\\cline{1-4}
{\bfseries{Steps}}   &Input   &Float   &The number of steps that the linear search of the algorithm performs.    \\\cline{1-4}
{\bfseries{UVs}}   &Input   &Vector2   &The UVs that the sampler uses to sample the Texture.    \\\cline{1-4}
{\bfseries{Tiling}}   &Input   &Vector2   &The tiling to apply to the input UVs.    \\\cline{1-4}
{\bfseries{Offset}}   &Input   &Vector2   &The offset to apply to the input UVs.    \\\cline{1-4}
{\bfseries{Primitive Size}}   &Input   &Vector2   &Size of the UV space in object space. For example, a \doxylink{namespace_unity}{Unity} built-\/in Plane mesh has a primitive size of (10,10).    \\\cline{1-4}
{\bfseries{LOD}}   &Input   &Float   &The level of detail to use to sample the {\bfseries{Heightmap}}. This value should always be positive.    \\\cline{1-4}
{\bfseries{LOD Threshold}}   &Input   &Float   &The {\bfseries{Heightmap}} mip level where the Parallax Occlusion Mapping effect begins to fade out. This is equivalent to the {\bfseries{Fading Mip Level Start}} property in the High Definition Render Pipeline\textquotesingle{}s (HDRP) \href{https://docs.unity3d.com/Packages/com.unity.render-pipelines.high-definition@latest/index.html?subfolder=/manual/Lit-Shader.html}{\texttt{ Lit Material}}.    \\\cline{1-4}
{\bfseries{Pixel Depth Offset}}   &Output   &Float   &The offset to apply to the depth buffer to produce the illusion of depth. Connect this output to the {\bfseries{Depth Offset}} on the Master Node to enable effects that rely on the depth buffer, such as shadows and screen space ambient occlusion.    \\\cline{1-4}
{\bfseries{Parallax UVs}}   &Output   &Vector2   &UVs that you have added the parallax offset to.   \\\cline{1-4}
\end{longtabu}
\hypertarget{md__hey_tea_9_2_library_2_package_cache_2com_8unity_8shadergraph_0d14_80_88_2_documentation_0i_2cc7285ab42c16b0a6e9a6671da5ba147_autotoc_md3587}{}\doxysection{\texorpdfstring{Generated Code Example}{Generated Code Example}}\label{md__hey_tea_9_2_library_2_package_cache_2com_8unity_8shadergraph_0d14_80_88_2_documentation_0i_2cc7285ab42c16b0a6e9a6671da5ba147_autotoc_md3587}
The following example code represents one possible outcome of this node.


\begin{DoxyCode}{0}
\DoxyCodeLine{float3\ ParallaxOcclusionMapping\_ViewDir\ =\ IN.TangentSpaceViewDirection\ *\ GetDisplacementObjectScale().xzy;}
\DoxyCodeLine{float\ ParallaxOcclusionMapping\_NdotV\ =\ ParallaxOcclusionMapping\_ViewDir.z;}
\DoxyCodeLine{float\ ParallaxOcclusionMapping\_MaxHeight\ =\ Amplitude\ *\ 0.01;}
\DoxyCodeLine{ParallaxOcclusionMapping\_MaxHeight\ *=\ 2.0\ /\ (\ abs(Tiling.x)\ +\ abs(Tiling.y)\ );}
\DoxyCodeLine{}
\DoxyCodeLine{float2\ ParallaxOcclusionMapping\_UVSpaceScale\ =\ ParallaxOcclusionMapping\_MaxHeight\ *\ Tiling\ /\ PrimitiveSize;}
\DoxyCodeLine{}
\DoxyCodeLine{//\ Transform\ the\ view\ vector\ into\ the\ UV\ space.}
\DoxyCodeLine{float3\ ParallaxOcclusionMapping\_ViewDirUV\ \ \ \ =\ normalize(float3(ParallaxOcclusionMapping\_ViewDir.xy\ *\ ParallaxOcclusionMapping\_UVSpaceScale,\ ParallaxOcclusionMapping\_ViewDir.z));\ //\ TODO:\ skip\ normalize}
\DoxyCodeLine{}
\DoxyCodeLine{PerPixelHeightDisplacementParam\ ParallaxOcclusionMapping\_POM;}
\DoxyCodeLine{ParallaxOcclusionMapping\_POM.uv\ =\ UVs.xy;}
\DoxyCodeLine{}
\DoxyCodeLine{float\ ParallaxOcclusionMapping\_OutHeight;}
\DoxyCodeLine{float2\ \_ParallaxOcclusionMapping\_ParallaxUVs\ =\ UVs.xy\ +\ ParallaxOcclusionMapping(Lod,\ Lod\_Threshold,\ Steps,\ ParallaxOcclusionMapping\_ViewDirUV,\ ParallaxOcclusionMapping\_POM,\ ParallaxOcclusionMapping\_OutHeight);}
\DoxyCodeLine{}
\DoxyCodeLine{float\ \_ParallaxOcclusionMapping\_PixelDepthOffset\ =\ (ParallaxOcclusionMapping\_MaxHeight\ -\/\ ParallaxOcclusionMapping\_OutHeight\ *\ ParallaxOcclusionMapping\_MaxHeight)\ /\ max(ParallaxOcclusionMapping\_NdotV,\ 0.0001);}

\end{DoxyCode}
 