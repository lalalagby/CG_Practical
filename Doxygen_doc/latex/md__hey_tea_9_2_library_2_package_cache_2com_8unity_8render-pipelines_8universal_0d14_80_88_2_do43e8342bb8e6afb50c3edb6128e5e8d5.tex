\chapter{Shader Stripping}
\hypertarget{md__hey_tea_9_2_library_2_package_cache_2com_8unity_8render-pipelines_8universal_0d14_80_88_2_do43e8342bb8e6afb50c3edb6128e5e8d5}{}\label{md__hey_tea_9_2_library_2_package_cache_2com_8unity_8render-pipelines_8universal_0d14_80_88_2_do43e8342bb8e6afb50c3edb6128e5e8d5}\index{Shader Stripping@{Shader Stripping}}
\label{md__hey_tea_9_2_library_2_package_cache_2com_8unity_8render-pipelines_8universal_0d14_80_88_2_do43e8342bb8e6afb50c3edb6128e5e8d5_autotoc_md2468}%
\Hypertarget{md__hey_tea_9_2_library_2_package_cache_2com_8unity_8render-pipelines_8universal_0d14_80_88_2_do43e8342bb8e6afb50c3edb6128e5e8d5_autotoc_md2468}%
 The shaders in the Universal Render Pipeline (URP) use \href{https://docs.unity3d.com/Manual/shader-keywords}{\texttt{ shader keywords}} to support many different features, which can mean \doxylink{namespace_unity}{Unity} compiles a lot of \href{https://docs.unity3d.com/Manual/shader-variants}{\texttt{ shader variants}}.

If you disable features in the \doxysectlink{md__hey_tea_9_2_library_2_package_cache_2com_8unity_8render-pipelines_8universal_0d14_80_88_2_do6a4fd81cefe986341b093c28ca9c1f30}{URP Asset}{0}, URP automatically excludes (\textquotesingle{}strips\textquotesingle{}) the related shader variants. This speeds up builds, and reduces memory usage and file sizes.

For example, if your project doesn\textquotesingle{}t use shadows for directional lights, by default \doxylink{namespace_unity}{Unity} still includes variants that support directional light shadows in your build. If you disable {\bfseries{Cast Shadows}} in the URP Asset, URP strips these variants.

If you want to examine the code that strips shaders in URP, see the {\ttfamily Editor/\+Shader\+Preprocessor.\+cs} file. The file uses the \href{https://docs.unity3d.com/ScriptReference/Build.IPreprocessShaders.html}{\texttt{ IPreprocess\+Shaders}} API.

For more information on stripping shader variants, see the following pages\+:


\begin{DoxyItemize}
\item \href{https://docs.unity3d.com/Manual/shader-how-many-variants.html}{\texttt{ Check how many shader variants you have}}.
\item See the \href{https://docs.unity3d.com/Manual/shader-variant-stripping.html}{\texttt{ standard guidance about shader stripping}}, which applies to all render pipelines.
\end{DoxyItemize}\hypertarget{md__hey_tea_9_2_library_2_package_cache_2com_8unity_8render-pipelines_8universal_0d14_80_88_2_do43e8342bb8e6afb50c3edb6128e5e8d5_autotoc_md2469}{}\doxysection{\texorpdfstring{Strip feature shader variants}{Strip feature shader variants}}\label{md__hey_tea_9_2_library_2_package_cache_2com_8unity_8render-pipelines_8universal_0d14_80_88_2_do43e8342bb8e6afb50c3edb6128e5e8d5_autotoc_md2469}
By default, URP compiles variants where a feature is enabled, and variants where a feature is disabled.

To reduce the number of variants, you can enable {\bfseries{Strip Unused Variants}} in the \doxysectlink{md__hey_tea_9_2_library_2_package_cache_2com_8unity_8render-pipelines_8universal_0d14_80_88_2_doece8285cd83d5279186a929bc731aefc}{URP Global Settings}{0} and do the following\+:


\begin{DoxyItemize}
\item Disable a feature in all URP Assets in your build, so URP keeps only variants where the feature is disabled.
\item Enable a feature in all URP Assets in your build, so URP keeps only variants where the feature is enabled.
\end{DoxyItemize}

If you disable the {\bfseries{Strip Unused Variants setting}}, URP can\textquotesingle{}t strip variants where the feature is disabled. This might increase the number of variants.\hypertarget{md__hey_tea_9_2_library_2_package_cache_2com_8unity_8render-pipelines_8universal_0d14_80_88_2_do43e8342bb8e6afb50c3edb6128e5e8d5_autotoc_md2470}{}\doxysubsection{\texorpdfstring{Disable a feature}{Disable a feature}}\label{md__hey_tea_9_2_library_2_package_cache_2com_8unity_8render-pipelines_8universal_0d14_80_88_2_do43e8342bb8e6afb50c3edb6128e5e8d5_autotoc_md2470}
To let \doxylink{namespace_unity}{Unity} strip variants related to a feature, make sure you disable it in all the URP Assets in your build.

\doxylink{namespace_unity}{Unity} includes the following URP Assets in your build\+:


\begin{DoxyItemize}
\item The URP Asset you set as the default render pipeline asset in \href{https://docs.unity3d.com/Manual/class-GraphicsSettings.html}{\texttt{ Graphics Settings}}.
\item Any URP Asset you set as a {\bfseries{Render Pipeline Asset}} in a \href{https://docs.unity3d.com/Manual/class-QualitySettings.html}{\texttt{ Quality Settings level}} you enable for the current build target.
\end{DoxyItemize}

Avoid including URP Assets in your build that use different \href{urp-universal-renderer.html\#rendering-path-comparison}{\texttt{ rendering paths}} because this causes \doxylink{namespace_unity}{Unity} to create two sets of variants for each keyword.

\tabulinesep=1mm
\begin{longtabu}spread 0pt [c]{*{4}{|X[-1]}|}
\hline
\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ {\bfseries{Feature}}   }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ {\bfseries{How to disable the feature}}   }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ {\bfseries{Shader keywords this turns off}}   }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ {\bfseries{Rendering Path}}    }\\\cline{1-4}
\endfirsthead
\hline
\endfoot
\hline
\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ {\bfseries{Feature}}   }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ {\bfseries{How to disable the feature}}   }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ {\bfseries{Shader keywords this turns off}}   }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ {\bfseries{Rendering Path}}    }\\\cline{1-4}
\endhead
Accurate G-\/buffer normals   &Disable {\bfseries{Accurate G-\/buffer normals}} in the URP Asset. This has no effect on platforms that use the Vulkan graphics API.   &{\ttfamily \+\_\+\+GBUFFER\+\_\+\+NORMALS\+\_\+\+OCT}   &Deferred    \\\cline{1-4}
Additional lights   &In the {\bfseries{URP Asset}}, in the {\bfseries{Lighting section}}, disable {\bfseries{Additional Lights}}.   &{\ttfamily \+\_\+\+ADDITIONAL\+\_\+\+LIGHTS}, {\ttfamily \+\_\+\+ADDITIONAL\+\_\+\+LIGHTS\+\_\+\+VERTEX}   &Forward    \\\cline{1-4}
Ambient occlusion   &Remove the \href{post-processing-ssao.html}{\texttt{ Ambient Occlusion}} Renderer Feature in all Renderers that URP Assets use.   &{\ttfamily \+\_\+\+SCREEN\+\_\+\+SPACE\+\_\+\+OCCLUSION}   &Forward and Deferred    \\\cline{1-4}
Decals   &Remove the \href{renderer-feature-decal.html}{\texttt{ Decals}} Renderer Feature in all Renderers that URP Assets use.   &{\ttfamily \+\_\+\+DBUFFER\+\_\+\+MRT1}, {\ttfamily \+\_\+\+DBUFFER\+\_\+\+MRT2}, {\ttfamily \+\_\+\+DBUFFER\+\_\+\+MRT3}, {\ttfamily \+\_\+\+DECAL\+\_\+\+NORMAL\+\_\+\+BLEND\+\_\+\+LOW}, {\ttfamily \+\_\+\+DECAL\+\_\+\+NORMAL\+\_\+\+BLEND\+\_\+\+MEDIUM}, {\ttfamily \+\_\+\+DECAL\+\_\+\+NORMAL\+\_\+\+BLEND\+\_\+\+HIGH}, {\ttfamily \+\_\+\+DECAL\+\_\+\+LAYERS}   &Forward and Deferred    \\\cline{1-4}
Fast s\+RGB to linear conversion   &In the {\bfseries{URP Asset}}, in the {\bfseries{Post-\/processing}} section, disable {\bfseries{Fast s\+RGB/\+Linear conversions}}.   &{\ttfamily \+\_\+\+USE\+\_\+\+FAST\+\_\+\+SRGB\+\_\+\+LINEAR\+\_\+\+CONVERSION}   &Forward and Deferred    \\\cline{1-4}
Holes in terrain   &In the {\bfseries{URP Asset}}, in the {\bfseries{Rendering}} section, disable {\bfseries{Terrain Holes}}.   &{\ttfamily \+\_\+\+ALPHATEST\+\_\+\+ON}   &Forward    \\\cline{1-4}
Light cookies   &Remove \href{https://docs.unity3d.com/Manual/Cookies.html}{\texttt{ Cookie textures}} from all the lights in your project.   &{\ttfamily \+\_\+\+LIGHT\+\_\+\+COOKIES}   &Forward and Deferred    \\\cline{1-4}
Rendering Layers for lights   &Disable \href{features/rendering-layers.html}{\texttt{ Rendering Layers for Lights}}.   &{\ttfamily \+\_\+\+LIGHT\+\_\+\+LAYERS}   &Forward and Deferred    \\\cline{1-4}
Reflection Probe blending   &Disable \href{lighting/reflection-probes.html\#configuring-reflection-probe-settings}{\texttt{ Probe Blending}}.   &{\ttfamily \+\_\+\+REFLECTION\+\_\+\+PROBE\+\_\+\+BLENDING}   &Forward and Deferred    \\\cline{1-4}
Reflection Probe box projection   &Disable \href{lighting/reflection-probes.html\#configuring-reflection-probe-settings}{\texttt{ Box Projection}}.   &{\ttfamily \+\_\+\+REFLECTION\+\_\+\+PROBE\+\_\+\+BOX\+\_\+\+PROJECTION}   &Forward and Deferred    \\\cline{1-4}
Render Pass   &Disable {\bfseries{Native Render}} in all Renderers that URP Assets use.   &{\ttfamily \+\_\+\+RENDER\+\_\+\+PASS\+\_\+\+ENABLED}   &Forward and Deferred    \\\cline{1-4}
Shadows from additional lights   &In the URP Asset, in the {\bfseries{Additional Lights}} section, disable {\bfseries{Cast Shadows}}.   &{\ttfamily \+\_\+\+ADDITIONAL\+\_\+\+LIGHT\+\_\+\+SHADOWS}   &Forward and Deferred    \\\cline{1-4}
Shadows from the main light   &In the URP Asset, in the {\bfseries{Main Light}} section, disable {\bfseries{Cast Shadows}}. The keywords \doxylink{namespace_unity}{Unity} removes might depend on your settings.   &{\ttfamily \+\_\+\+MAIN\+\_\+\+LIGHT\+\_\+\+SHADOWS}, {\ttfamily \+\_\+\+MAIN\+\_\+\+LIGHT\+\_\+\+SHADOWS\+\_\+\+CASCADE}, {\ttfamily \+\_\+\+MAIN\+\_\+\+LIGHT\+\_\+\+SHADOWS\+\_\+\+SCREEN}   &Forward and Deferred    \\\cline{1-4}
Soft shadows   &In the URP Asset, in the {\bfseries{Shadows}} section, disable {\bfseries{Soft shadows}}.   &{\ttfamily \+\_\+\+SHADOWS\+\_\+\+SOFT}   &Forward and Deferred   \\\cline{1-4}
\end{longtabu}
\hypertarget{md__hey_tea_9_2_library_2_package_cache_2com_8unity_8render-pipelines_8universal_0d14_80_88_2_do43e8342bb8e6afb50c3edb6128e5e8d5_autotoc_md2471}{}\doxysection{\texorpdfstring{Strip post-\/processing shader variants}{Strip post-\/processing shader variants}}\label{md__hey_tea_9_2_library_2_package_cache_2com_8unity_8render-pipelines_8universal_0d14_80_88_2_do43e8342bb8e6afb50c3edb6128e5e8d5_autotoc_md2471}
Enable {\bfseries{Strip Unused Post Processing Variants}} in \doxysectlink{md__hey_tea_9_2_library_2_package_cache_2com_8unity_8render-pipelines_8universal_0d14_80_88_2_doece8285cd83d5279186a929bc731aefc}{URP Global Settings}{0} to strip shader variants for \doxysectlink{md__hey_tea_9_2_library_2_package_cache_2com_8unity_8render-pipelines_8universal_0d14_80_88_2_do5d8e84fb42b2bb0720761c155081d9b4}{Volume Overrides}{0} you don\textquotesingle{}t use.

For example if your project uses only the Bloom effect, URP keeps Bloom variants but strips all other post-\/processing variants.

\doxylink{namespace_unity}{Unity} checks for Volume Overrides in all scenes, so you can\textquotesingle{}t strip variants by removing a Scene from your build but keeping it in your project.

\tabulinesep=1mm
\begin{longtabu}spread 0pt [c]{*{2}{|X[-1]}|}
\hline
\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ {\bfseries{Volume Override removed}}   }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ {\bfseries{Shader keywords this turns off}}    }\\\cline{1-2}
\endfirsthead
\hline
\endfoot
\hline
\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ {\bfseries{Volume Override removed}}   }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ {\bfseries{Shader keywords this turns off}}    }\\\cline{1-2}
\endhead
Bloom   &{\ttfamily \+\_\+\+BLOOM\+\_\+\+HQ}, {\ttfamily BLOOM\+\_\+\+HQ\+\_\+\+DIRT}, {\ttfamily \+\_\+\+BLOOM\+\_\+\+LQ}, {\ttfamily BLOOM\+\_\+\+LQ\+\_\+\+DIRT}    \\\cline{1-2}
Chromatic Aberration   &{\ttfamily \+\_\+\+CHROMATIC\+\_\+\+ABERRATION}    \\\cline{1-2}
Film Grain   &{\ttfamily \+\_\+\+FILM\+\_\+\+GRAIN}    \\\cline{1-2}
HDR Grading   &{\ttfamily \+\_\+\+HDR\+\_\+\+GRADING}    \\\cline{1-2}
Lens Distortion   &{\ttfamily \+\_\+\+DISTORTION}    \\\cline{1-2}
Tonemapping   &{\ttfamily \+\_\+\+TONEMAP\+\_\+\+ACES}, {\ttfamily \+\_\+\+TONEMAP\+\_\+\+NEUTRAL}, {\ttfamily \+\_\+\+TONEMAP\+\_\+\+GRADING}   \\\cline{1-2}
\end{longtabu}


You should also enable {\bfseries{Strip Screen Coord Override Variants}} in URP Global Settings, unless you override screen coordinates to support post processing on large numbers of multiple displays (\textquotesingle{}cluster\textquotesingle{} displays).\hypertarget{md__hey_tea_9_2_library_2_package_cache_2com_8unity_8render-pipelines_8universal_0d14_80_88_2_do43e8342bb8e6afb50c3edb6128e5e8d5_autotoc_md2472}{}\doxysection{\texorpdfstring{Strip XR and VR shader variants}{Strip XR and VR shader variants}}\label{md__hey_tea_9_2_library_2_package_cache_2com_8unity_8render-pipelines_8universal_0d14_80_88_2_do43e8342bb8e6afb50c3edb6128e5e8d5_autotoc_md2472}
If you don\textquotesingle{}t use \href{https://docs.unity3d.com/Manual/XR.html}{\texttt{ XR}} or \href{https://docs.unity3d.com/Manual/VROverview.html}{\texttt{ VR}}, you can \href{https://docs.unity3d.com/Documentation/Manual/upm-ui.html}{\texttt{ disable the XR and VR modules}}. This allows URP to strip XR and VR related shader variants from its standard shaders.\hypertarget{md__hey_tea_9_2_library_2_package_cache_2com_8unity_8render-pipelines_8universal_0d14_80_88_2_do43e8342bb8e6afb50c3edb6128e5e8d5_autotoc_md2473}{}\doxysection{\texorpdfstring{Remove variants if you use a custom Renderer Feature}{Remove variants if you use a custom Renderer Feature}}\label{md__hey_tea_9_2_library_2_package_cache_2com_8unity_8render-pipelines_8universal_0d14_80_88_2_do43e8342bb8e6afb50c3edb6128e5e8d5_autotoc_md2473}
If you create a \href{xref:UnityEngine.Rendering.Universal.ScriptableRendererFeature}{\texttt{ custom Renderer Feature}}, you can use the \href{https://docs.unity3d.com/2023.1/Documentation/ScriptReference/ShaderKeywordFilter.FilterAttribute.html}{\texttt{ Filter\+Attribute}} API to remove shader variants when you enable or disable settings in the \doxysectlink{md__hey_tea_9_2_library_2_package_cache_2com_8unity_8render-pipelines_8universal_0d14_80_88_2_do6a4fd81cefe986341b093c28ca9c1f30}{URP Asset}{0}.

For example, you can do the following\+:


\begin{DoxyEnumerate}
\item Use \href{https://docs.unity3d.com/ScriptReference/SerializeField.html}{\texttt{ \mbox{[}Serialize\+Field\mbox{]}}} to add a Boolean variable to the custom Renderer Feature and add it as a checkbox in the URP Asset Inspector.
\item Use \href{https://docs.unity3d.com/2023.1/Documentation/ScriptReference/ShaderKeywordFilter.RemoveIfAttribute.html}{\texttt{ Shader\+Keyword\+Filter.\+Remove\+If}} to remove shader variants when you enable the checkbox. 
\end{DoxyEnumerate}