\chapter{Visualizing normal vectors}
\hypertarget{md__hey_tea_9_2_library_2_package_cache_2com_8unity_8render-pipelines_8universal_0d14_80_88_2_do93945fe33cc7a050828f7ab1184ad1b6}{}\label{md__hey_tea_9_2_library_2_package_cache_2com_8unity_8render-pipelines_8universal_0d14_80_88_2_do93945fe33cc7a050828f7ab1184ad1b6}\index{Visualizing normal vectors@{Visualizing normal vectors}}
\label{md__hey_tea_9_2_library_2_package_cache_2com_8unity_8render-pipelines_8universal_0d14_80_88_2_do93945fe33cc7a050828f7ab1184ad1b6_autotoc_md2710}%
\Hypertarget{md__hey_tea_9_2_library_2_package_cache_2com_8unity_8render-pipelines_8universal_0d14_80_88_2_do93945fe33cc7a050828f7ab1184ad1b6_autotoc_md2710}%
 The \doxylink{namespace_unity}{Unity} shader in this example visualizes the normal vector values on the mesh.

Use the \doxylink{namespace_unity}{Unity} shader source file from section \doxysectlink{md__hey_tea_9_2_library_2_package_cache_2com_8unity_8render-pipelines_8universal_0d14_80_88_2_doede214fd129bc83b060cf416b47c1ca5}{URP unlit basic shader}{0} and make the following changes to the Shader\+Lab code\+:


\begin{DoxyEnumerate}
\item In {\ttfamily struct Attributes}, which is the input structure for the vertex shader in this example, declare the variable containing the normal vector for each vertex.


\begin{DoxyCode}{0}
\DoxyCodeLine{++}
\DoxyCodeLine{\ \ \ \textcolor{keyword}{struct\ }Attributes}
\DoxyCodeLine{\ \ \ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ float4\ positionOS\ \ \ :\ POSITION;}
\DoxyCodeLine{\ \ \ \ \ \ \ \textcolor{comment}{//\ Declaring\ the\ variable\ containing\ the\ normal\ vector\ for\ each\ vertex.}}
\DoxyCodeLine{\ \ \ \ \ \ \ half3\ normal\ \ \ \ \ \ \ \ :\ NORMAL;}
\DoxyCodeLine{\ \ \ \};}

\end{DoxyCode}

\item In {\ttfamily struct Varyings}, which is the input structure for the fragment shader in this example, declare the variable for storing the normal vector values for each fragment\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{++}
\DoxyCodeLine{\ \ \ \textcolor{keyword}{struct\ }Varyings}
\DoxyCodeLine{\ \ \ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ float4\ positionHCS\ \ :\ SV\_POSITION;}
\DoxyCodeLine{\ \ \ \ \ \ \ \textcolor{comment}{//\ The\ variable\ for\ storing\ the\ normal\ vector\ values.}}
\DoxyCodeLine{\ \ \ \ \ \ \ half3\ normal\ \ \ \ \ \ \ \ :\ TEXCOORD0;}
\DoxyCodeLine{\ \ \ \};}

\end{DoxyCode}


This example uses the three components of the normal vector as RGB color values for each fragment.
\item To render the normal vector values on the mesh, use the following code as the fragment shader\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{++}
\DoxyCodeLine{\ \ \ half4\ frag(Varyings\ IN)\ :\ SV\_Target}
\DoxyCodeLine{\ \ \ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ half4\ color\ =\ 0;}
\DoxyCodeLine{\ \ \ \ \ \ \ color.rgb\ =\ IN.normal;}
\DoxyCodeLine{\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ color;}
\DoxyCodeLine{\ \ \ \}}

\end{DoxyCode}

\item \doxylink{namespace_unity}{Unity} renders the normal vector values on the mesh\+:



A part of the capsule is black. This is because in those points, all three components of the normal vector are negative. The next step shows how to render values in those areas as well.
\item To render negative normal vector components, use the compression technique. To compress the range of normal component values {\ttfamily (-\/1..1)} to color value range {\ttfamily (0..1)}, change the following line\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{++}
\DoxyCodeLine{\ \ \ color.rgb\ =\ IN.normal;}

\end{DoxyCode}


to this line\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{++}
\DoxyCodeLine{\ \ \ color.rgb\ =\ IN.normal\ *\ 0.5\ +\ 0.5;}

\end{DoxyCode}

\end{DoxyEnumerate}

Now \doxylink{namespace_unity}{Unity} renders the normal vector values as colors on the mesh.



Below is the complete Shader\+Lab code for this example.


\begin{DoxyCode}{0}
\DoxyCodeLine{\ ++}
\DoxyCodeLine{\textcolor{comment}{//\ This\ shader\ visuzlizes\ the\ normal\ vector\ values\ on\ the\ mesh.}}
\DoxyCodeLine{Shader\ \textcolor{stringliteral}{"{}Example/URPUnlitShaderNormal"{}}}
\DoxyCodeLine{\{}
\DoxyCodeLine{\ \ \ \ Properties}
\DoxyCodeLine{\ \ \ \ \{\ \}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ SubShader}
\DoxyCodeLine{\ \ \ \ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ Tags\ \{\ \textcolor{stringliteral}{"{}RenderType"{}}\ =\ \textcolor{stringliteral}{"{}Opaque"{}}\ \textcolor{stringliteral}{"{}RenderPipeline"{}}\ =\ \textcolor{stringliteral}{"{}UniversalPipeline"{}}\ \}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ Pass}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ HLSLPROGRAM}
\DoxyCodeLine{\textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \#pragma\ vertex\ vert}}
\DoxyCodeLine{\textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \#pragma\ fragment\ frag}}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \#include\ "{}Packages/com.unity.render-\/pipelines.universal/ShaderLibrary/Core.hlsl"{}}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{struct\ }Attributes}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ float4\ positionOS\ \ \ :\ POSITION;}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Declaring\ the\ variable\ containing\ the\ normal\ vector\ for\ each}}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ vertex.}}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ half3\ normal\ \ \ \ \ \ \ \ :\ NORMAL;}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \};}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{struct\ }Varyings}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ float4\ positionHCS\ \ :\ SV\_POSITION;}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ half3\ normal\ \ \ \ \ \ \ \ :\ TEXCOORD0;}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \};}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ Varyings\ vert(Attributes\ IN)}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Varyings\ OUT;}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ OUT.positionHCS\ =\ TransformObjectToHClip(IN.positionOS.xyz);}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Use\ the\ TransformObjectToWorldNormal\ function\ to\ transform\ the}}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ normals\ from\ object\ to\ world\ space.\ This\ function\ is\ from\ the}}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ SpaceTransforms.hlsl\ file,\ which\ is\ referenced\ in\ Core.hlsl.}}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ OUT.normal\ =\ TransformObjectToWorldNormal(IN.normal);}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ OUT;}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ half4\ frag(Varyings\ IN)\ :\ SV\_Target}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ half4\ color\ =\ 0;}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ IN.normal\ is\ a\ 3D\ vector.\ Each\ vector\ component\ has\ the\ range}}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ -\/1..1.\ To\ show\ all\ vector\ elements\ as\ color,\ including\ the}}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ negative\ values,\ compress\ each\ value\ into\ the\ range\ 0..1.}}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ color.rgb\ =\ IN.normal\ *\ 0.5\ +\ 0.5;}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ color;}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ ENDHLSL}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\ \ \ \ \}}
\DoxyCodeLine{\}}

\end{DoxyCode}
 