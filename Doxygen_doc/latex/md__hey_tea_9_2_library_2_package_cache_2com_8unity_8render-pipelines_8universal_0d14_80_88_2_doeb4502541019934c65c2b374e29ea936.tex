\chapter{Perform a full screen blit in URP}
\hypertarget{md__hey_tea_9_2_library_2_package_cache_2com_8unity_8render-pipelines_8universal_0d14_80_88_2_doeb4502541019934c65c2b374e29ea936}{}\label{md__hey_tea_9_2_library_2_package_cache_2com_8unity_8render-pipelines_8universal_0d14_80_88_2_doeb4502541019934c65c2b374e29ea936}\index{Perform a full screen blit in URP@{Perform a full screen blit in URP}}
\label{md__hey_tea_9_2_library_2_package_cache_2com_8unity_8render-pipelines_8universal_0d14_80_88_2_doeb4502541019934c65c2b374e29ea936_autotoc_md2412}%
\Hypertarget{md__hey_tea_9_2_library_2_package_cache_2com_8unity_8render-pipelines_8universal_0d14_80_88_2_doeb4502541019934c65c2b374e29ea936_autotoc_md2412}%
 The example on this page describes how to create a custom Renderer Feature that performs a full screen blit.\hypertarget{md__hey_tea_9_2_library_2_package_cache_2com_8unity_8render-pipelines_8universal_0d14_80_88_2_doeb4502541019934c65c2b374e29ea936_autotoc_md2413}{}\doxysection{\texorpdfstring{Example overview}{Example overview}}\label{md__hey_tea_9_2_library_2_package_cache_2com_8unity_8render-pipelines_8universal_0d14_80_88_2_doeb4502541019934c65c2b374e29ea936_autotoc_md2413}
This example implements the following solution\+:


\begin{DoxyItemize}
\item A \href{https://docs.unity3d.com/Packages/com.unity.render-pipelines.universal@12.0/api/UnityEngine.Rendering.Universal.ScriptableRendererFeature.html}{\texttt{ custom Renderer Feature}} calls a custom \href{https://docs.unity3d.com/Packages/com.unity.render-pipelines.universal@12.0/api/UnityEngine.Rendering.Universal.ScriptableRenderPass.html}{\texttt{ Render Pass}}.
\item The \href{https://docs.unity3d.com/Packages/com.unity.render-pipelines.universal@12.0/api/UnityEngine.Rendering.Universal.ScriptableRenderPass.html}{\texttt{ Render Pass}} blits the Opaque Texture to the the \href{https://docs.unity3d.com/Packages/com.unity.render-pipelines.universal@7.0/api/UnityEngine.Rendering.Universal.ScriptableRenderer.html\#UnityEngine_Rendering_Universal_ScriptableRenderer_cameraColorTarget}{\texttt{ Camera color target}} for the current renderer. The render pass uses the command buffer to draw a full screen mesh for both eyes.
\end{DoxyItemize}

The example includes \doxylink{md__hey_tea_9_2_library_2_package_cache_2com_8unity_8render-pipelines_8universal_0d14_80_88_2_doeb4502541019934c65c2b374e29ea936_shader}{the shader} that performs the GPU side of the rendering. The shader samples the color buffer using XR sampler macros.\hypertarget{md__hey_tea_9_2_library_2_package_cache_2com_8unity_8render-pipelines_8universal_0d14_80_88_2_doeb4502541019934c65c2b374e29ea936_autotoc_md2414}{}\doxysection{\texorpdfstring{Prerequisites}{Prerequisites}}\label{md__hey_tea_9_2_library_2_package_cache_2com_8unity_8render-pipelines_8universal_0d14_80_88_2_doeb4502541019934c65c2b374e29ea936_autotoc_md2414}
This example requires the following\+:


\begin{DoxyItemize}
\item The {\bfseries{Scriptable Render Pipeline Settings}} property refers to a URP asset ({\bfseries{Project Settings}} \texorpdfstring{$>$}{>} {\bfseries{\doxylink{namespace_graphics}{Graphics}}} \texorpdfstring{$>$}{>} {\bfseries{Scriptable Render Pipeline Settings}}).
\end{DoxyItemize}\hypertarget{md__hey_tea_9_2_library_2_package_cache_2com_8unity_8render-pipelines_8universal_0d14_80_88_2_doeb4502541019934c65c2b374e29ea936_autotoc_md2415}{}\doxysection{\texorpdfstring{\label{_example-objects}%
Create example Scene and Game\+Objects}{\label{_example-objects}%
Create example Scene and Game\+Objects}}\label{md__hey_tea_9_2_library_2_package_cache_2com_8unity_8render-pipelines_8universal_0d14_80_88_2_doeb4502541019934c65c2b374e29ea936_autotoc_md2415}
To follow the steps in this example, create a new Scene with the following Game\+Objects\+:


\begin{DoxyEnumerate}
\item Create a Cube. Ensure that the Cube is clearly visible from the main Camera.


\end{DoxyEnumerate}

Now you have the Scene necessary to follow the steps in this example.\hypertarget{md__hey_tea_9_2_library_2_package_cache_2com_8unity_8render-pipelines_8universal_0d14_80_88_2_doeb4502541019934c65c2b374e29ea936_autotoc_md2416}{}\doxysection{\texorpdfstring{Example implementation}{Example implementation}}\label{md__hey_tea_9_2_library_2_package_cache_2com_8unity_8render-pipelines_8universal_0d14_80_88_2_doeb4502541019934c65c2b374e29ea936_autotoc_md2416}
This section assumes that you created a Scene as described in section Create example Scene and Game\+Objects.

Follow these steps to create a \href{https://docs.unity3d.com/Packages/com.unity.render-pipelines.universal@12.0/api/UnityEngine.Rendering.Universal.ScriptableRendererFeature.html}{\texttt{ custom Renderer Feature}} with a custom \href{https://docs.unity3d.com/Packages/com.unity.render-pipelines.universal@12.0/api/UnityEngine.Rendering.Universal.ScriptableRenderPass.html}{\texttt{ Render Pass}}.


\begin{DoxyEnumerate}
\item Create a new C\# script. Call it {\ttfamily Color\+Blit\+Renderer\+Feature.\+cs}. This script implements the custom Renderer Feature.


\begin{DoxyCode}{0}
\DoxyCodeLine{\textcolor{preprocessor}{\#}}
\DoxyCodeLine{\ \ \ \textcolor{keyword}{using\ }\mbox{\hyperlink{namespace_unity_engine}{UnityEngine}};}
\DoxyCodeLine{\ \ \ \textcolor{keyword}{using\ }UnityEngine.Rendering;}
\DoxyCodeLine{\ \ \ \textcolor{keyword}{using\ }UnityEngine.Rendering.Universal;}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ internal\ \textcolor{keyword}{class\ }ColorBlitRendererFeature\ :\ \mbox{\hyperlink{class_unity_engine_1_1_rendering_1_1_universal_1_1_scriptable_renderer_feature}{ScriptableRendererFeature}}}
\DoxyCodeLine{\ \ \ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \textcolor{keyword}{public}\ Shader\ m\_Shader;}
\DoxyCodeLine{\ \ \ \ \ \ \ \textcolor{keyword}{public}\ \textcolor{keywordtype}{float}\ m\_Intensity;}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \ \ \ \mbox{\hyperlink{namespace_unity_editor_1_1_rendering_1_1_universal_a7dc4ea5121011414a2a206509b9d5442ad92a8333dd3ccb895cc65f7455b71206}{Material}}\ m\_Material;}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \ \ \ ColorBlitPass\ m\_RenderPass\ =\ null;}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \ \ \ \textcolor{keyword}{public}\ \textcolor{keyword}{override}\ \textcolor{keywordtype}{void}\ AddRenderPasses(\mbox{\hyperlink{class_unity_engine_1_1_rendering_1_1_universal_1_1_scriptable_renderer}{ScriptableRenderer}}\ renderer,}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ref\ \mbox{\hyperlink{struct_unity_engine_1_1_rendering_1_1_universal_1_1_rendering_data}{RenderingData}}\ renderingData)}
\DoxyCodeLine{\ \ \ \ \ \ \ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (renderingData.cameraData.cameraType\ ==\ CameraType.Game)}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ renderer.\mbox{\hyperlink{class_unity_engine_1_1_rendering_1_1_universal_1_1_scriptable_renderer_adef70d792e8e83c7feab314db83b02f2}{EnqueuePass}}(m\_RenderPass);}
\DoxyCodeLine{\ \ \ \ \ \ \ \}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \ \ \ \textcolor{keyword}{public}\ \textcolor{keyword}{override}\ \textcolor{keywordtype}{void}\ SetupRenderPasses(\mbox{\hyperlink{class_unity_engine_1_1_rendering_1_1_universal_1_1_scriptable_renderer}{ScriptableRenderer}}\ renderer,}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ in\ \mbox{\hyperlink{struct_unity_engine_1_1_rendering_1_1_universal_1_1_rendering_data}{RenderingData}}\ renderingData)}
\DoxyCodeLine{\ \ \ \ \ \ \ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (renderingData.cameraData.cameraType\ ==\ CameraType.Game)}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Calling\ ConfigureInput\ with\ the\ ScriptableRenderPassInput.Color\ argument}}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ ensures\ that\ the\ opaque\ texture\ is\ available\ to\ the\ Render\ Pass.}}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ m\_RenderPass.ConfigureInput(\mbox{\hyperlink{namespace_unity_engine_1_1_rendering_1_1_universal_a37daf716e998b874ec0272773287835b}{ScriptableRenderPassInput}}.Color);}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ m\_RenderPass.SetTarget(renderer.\mbox{\hyperlink{class_unity_engine_1_1_rendering_1_1_universal_1_1_scriptable_renderer_a6dd1c6ae076f6c30293e73eb080ff6ca}{cameraColorTargetHandle}},\ m\_Intensity);}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\ \ \ \ \ \ \ \}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \ \ \ \textcolor{keyword}{public}\ \textcolor{keyword}{override}\ \textcolor{keywordtype}{void}\ Create()}
\DoxyCodeLine{\ \ \ \ \ \ \ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ m\_Material\ =\ CoreUtils.CreateEngineMaterial(m\_Shader);}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ m\_RenderPass\ =\ \textcolor{keyword}{new}\ ColorBlitPass(m\_Material);}
\DoxyCodeLine{\ \ \ \ \ \ \ \}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \ \ \ \textcolor{keyword}{protected}\ \textcolor{keyword}{override}\ \textcolor{keywordtype}{void}\ Dispose(\textcolor{keywordtype}{bool}\ disposing)}
\DoxyCodeLine{\ \ \ \ \ \ \ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ CoreUtils.Destroy(m\_Material);}
\DoxyCodeLine{\ \ \ \ \ \ \ \}}
\DoxyCodeLine{\ \ \ \}}

\end{DoxyCode}

\item Create a new C\# script. Call it {\ttfamily Color\+Blit\+Pass.\+cs}. This script implements the custom Render Pass that performs the custom blit draw call.

This Render Pass uses the {\ttfamily Blitter.\+Blit\+Camera\+Texture} method to draw a full-\/screen quad and perform the blit operation.
\end{DoxyEnumerate}

\begin{quote}
{\bfseries{NOTE\+:}} Do not use the {\ttfamily cmd.\+Blit} method in URP XR projects because that method has compatibility issues with the URP XR integration. Using {\ttfamily cmd.\+Blit} might implicitly enable or disable XR shader keywords, which breaks XR SPI rendering. \end{quote}


\`{}\`{}\`{}C\# using \doxylink{namespace_unity_engine}{Unity\+Engine}; using \doxylink{namespace_unity_engine_1_1_rendering}{Unity\+Engine.\+Rendering}; using \doxylink{namespace_unity_engine_1_1_rendering_1_1_universal}{Unity\+Engine.\+Rendering.\+Universal};

internal class Color\+Blit\+Pass \+: Scriptable\+Render\+Pass \{ Profiling\+Sampler m\+\_\+\+Profiling\+Sampler = new Profiling\+Sampler("{}\+Color\+Blit"{}); Material m\+\_\+\+Material; RTHandle m\+\_\+\+Camera\+Color\+Target; float m\+\_\+\+Intensity;

public Color\+Blit\+Pass(\+Material material) \{ m\+\_\+\+Material = material; render\+Pass\+Event = Render\+Pass\+Event.\+Before\+Rendering\+Post\+Processing; \}

public void Set\+Target(\+RTHandle color\+Handle, float intensity) \{ m\+\_\+\+Camera\+Color\+Target = color\+Handle; m\+\_\+\+Intensity = intensity; \}

public override void On\+Camera\+Setup(\+Command\+Buffer cmd, ref Rendering\+Data rendering\+Data) \{ Configure\+Target(m\+\_\+\+Camera\+Color\+Target); \}

public override void Execute(\+Scriptable\+Render\+Context context, ref Rendering\+Data rendering\+Data) \{ var camera\+Data = rendering\+Data.\+camera\+Data; if (camera\+Data.\+camera.\+camera\+Type != Camera\+Type.\+Game) return;

if (m\+\_\+\+Material == null) return;

Command\+Buffer cmd = Command\+Buffer\+Pool.\+Get(); using (new Profiling\+Scope(cmd, m\+\_\+\+Profiling\+Sampler)) \{ m\+\_\+\+Material.\+Set\+Float("{}\+\_\+\+Intensity"{}, m\+\_\+\+Intensity); Blitter.\+Blit\+Camera\+Texture(cmd, m\+\_\+\+Camera\+Color\+Target, m\+\_\+\+Camera\+Color\+Target, m\+\_\+\+Material, 0); \} context.\+Execute\+Command\+Buffer(cmd); cmd.\+Clear();

Command\+Buffer\+Pool.\+Release(cmd); \} \} \`{}\`{}\`{}


\begin{DoxyEnumerate}
\item \label{md__hey_tea_9_2_library_2_package_cache_2com_8unity_8render-pipelines_8universal_0d14_80_88_2_doeb4502541019934c65c2b374e29ea936_shader}%
\Hypertarget{md__hey_tea_9_2_library_2_package_cache_2com_8unity_8render-pipelines_8universal_0d14_80_88_2_doeb4502541019934c65c2b374e29ea936_shader}%

\end{DoxyEnumerate}Create the shader that performs the blit operation. Call the shader file {\ttfamily Color\+Blit.\+shader}. The vertex function outputs the full-\/screen quad position. The fragment function samples the color buffer and returns the {\ttfamily color \texorpdfstring{$\ast$}{*} float4(0, \+\_\+\+Intensity, 0, 1)} value to the render target.


\begin{DoxyCode}{0}
\DoxyCodeLine{Shader\ "{}ColorBlit"{}}
\DoxyCodeLine{\{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ SubShader}
\DoxyCodeLine{\ \ \ \ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ Tags\ \{\ "{}RenderType"{}="{}Opaque"{}\ "{}RenderPipeline"{}\ =\ "{}UniversalPipeline"{}\}}
\DoxyCodeLine{\ \ \ \ \ \ \ \ LOD\ 100}
\DoxyCodeLine{\ \ \ \ \ \ \ \ ZWrite\ Off\ Cull\ Off}
\DoxyCodeLine{\ \ \ \ \ \ \ \ Pass}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ Name\ "{}ColorBlitPass"{}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ HLSLPROGRAM}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \#include\ "{}Packages/com.unity.render-\/pipelines.universal/ShaderLibrary/Core.hlsl"{}}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ //\ The\ Blit.hlsl\ file\ provides\ the\ vertex\ shader\ (Vert),}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ //\ input\ structure\ (Attributes)\ and\ output\ strucutre\ (Varyings)}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \#include\ "{}Packages/com.unity.render-\/pipelines.core/Runtime/Utilities/Blit.hlsl"{}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \#pragma\ vertex\ Vert}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \#pragma\ fragment\ frag}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ TEXTURE2D\_X(\_CameraOpaqueTexture);}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ SAMPLER(sampler\_CameraOpaqueTexture);}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ float\ \_Intensity;}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ half4\ frag\ (Varyings\ input)\ :\ SV\_Target}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ UNITY\_SETUP\_STEREO\_EYE\_INDEX\_POST\_VERTEX(input);}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ float4\ color\ =\ SAMPLE\_TEXTURE2D\_X(\_CameraOpaqueTexture,\ sampler\_CameraOpaqueTexture,\ input.texcoord);}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ return\ color\ *\ float4(0,\ \_Intensity,\ 0,\ 1);}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ ENDHLSL}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\ \ \ \ \}}
\DoxyCodeLine{\}}

\end{DoxyCode}



\begin{DoxyEnumerate}
\item Add the {\ttfamily Color\+Blit\+Renderer\+Feature} to the Universal Renderer asset.



For information on how to add a Renderer Feature, see the page \doxysectlink{md__hey_tea_9_2_library_2_package_cache_2com_8unity_8render-pipelines_8universal_0d14_80_88_2_dobad63f519f0fde26755d12ecfe7020ca}{How to add a Renderer Feature to a Renderer}{0}.

For this example, set the Intensity property to 1.\+5.
\item \doxylink{namespace_unity}{Unity} shows the following views\+:


\end{DoxyEnumerate}

\begin{quote}
{\bfseries{NOTE\+:}} To visualize the example in XR, configure the project to use XR SDK. \href{https://docs.unity3d.com/Packages/com.unity.xr.mock-hmd@latest/index.html}{\texttt{ Add the Mock\+HMD XR Plugin to the project}}. Set the {\bfseries{Render Mode}} property to {\bfseries{Single Pass Instanced}}. \end{quote}


The example is complete. 